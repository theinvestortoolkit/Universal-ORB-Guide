<!-- Chosen Palette: TradingView Classic (Stone background, Emerald/Rose for price action, Indigo/Amber for levels) -->
<!-- Application Structure Plan: A 5-phase interactive guide (Overview, Identify, Execute, Manage, Context). Includes the requested strategy description and copyright footer. -->
<!-- Visualization & Content Choices: 
1. Strategy Overview: A new summary section explaining the logic.
2. Visual Legend: Line chart with a 'box' annotation (Canvas) to show the Gray Range. 
3. Strategy Simulator: Direction Toggle (Long/Short) + 4 Entry Types.
4. Risk Calculator: Position sizing based on Stop Loss Width.
5. Timeframes: Reordered 5m -> 15m -> 30m. 
CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal ORB Strategy Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 850px; margin: auto; height: 380px; }
        .tab-active { border-bottom: 2px solid #10b981; color: #10b981; font-weight: 700; }
        .tab-inactive { color: #78716c; border-bottom: 2px solid transparent; }
        .strategy-btn.active { border-color: #10b981; background-color: #f0fdf4; box-shadow: 0 0 0 2px #10b981; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 antialiased flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-white border-b border-stone-200 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-emerald-600 rounded flex items-center justify-center text-white font-bold">U</div>
                <h1 class="text-xl font-bold text-stone-900">Universal ORB <span class="text-stone-400 font-normal">Dashboard</span></h1>
            </div>
            <div class="text-xs bg-stone-100 px-2 py-1 rounded text-stone-500 font-mono">STABLE v1.2</div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white border-b border-stone-200">
        <div class="max-w-6xl mx-auto px-4 sm:px-6">
            <div class="flex space-x-8 overflow-x-auto no-scrollbar">
                <button onclick="switchTab('overview')" id="tab-overview" class="tab-active py-4 px-1 text-sm whitespace-nowrap transition-all cursor-pointer">1. Strategy Overview</button>
                <button onclick="switchTab('visuals')" id="tab-visuals" class="tab-inactive py-4 px-1 text-sm whitespace-nowrap transition-all cursor-pointer">2. Visual Legend</button>
                <button onclick="switchTab('strategies')" id="tab-strategies" class="tab-inactive py-4 px-1 text-sm whitespace-nowrap transition-all cursor-pointer">3. Long vs Short</button>
                <button onclick="switchTab('risk')" id="tab-risk" class="tab-inactive py-4 px-1 text-sm whitespace-nowrap transition-all cursor-pointer">4. Risk Management</button>
                <button onclick="switchTab('context')" id="tab-context" class="tab-inactive py-4 px-1 text-sm whitespace-nowrap transition-all cursor-pointer">5. Market Context</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow max-w-6xl mx-auto px-4 sm:px-6 py-8 w-full">

        <!-- SECTION 1: STRATEGY OVERVIEW -->
        <section id="content-overview" class="space-y-8 animate-in fade-in duration-500">
            <div class="max-w-3xl">
                <h2 class="text-3xl font-extrabold text-stone-900 tracking-tight">What is the Opening Range Breakout?</h2>
                <p class="text-lg text-stone-600 mt-4 leading-relaxed">
                    The <strong>Opening Range Breakout (ORB)</strong> is a high-probability momentum strategy used to capture the "trend of the day." It is based on the principle that the first few minutes of the trading session represent the most intense battle between buyers and sellers.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-stone-200">
                    <div class="w-10 h-10 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                    </div>
                    <h3 class="font-bold text-stone-900 mb-2">The Catalyst</h3>
                    <p class="text-sm text-stone-500 leading-relaxed">Early morning volatility is driven by institutional orders, overnight news, and retail panic. This creates a "range" that acts as a blueprint for the rest of the day.</p>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-stone-200">
                    <div class="w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                    </div>
                    <h3 class="font-bold text-stone-900 mb-2">The Timeframe</h3>
                    <p class="text-sm text-stone-500 leading-relaxed">Most traders focus on the first 5, 15, or 30 minutes. Once this period ends, the high and low of that time window become the key "triggers" for a trade.</p>
                </div>
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-stone-200">
                    <div class="w-10 h-10 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>
                    </div>
                    <h3 class="font-bold text-stone-900 mb-2">The Objective</h3>
                    <p class="text-sm text-stone-500 leading-relaxed">We wait for the price to "break out" (Long) or "break down" (Short) from this range. The goal is to ride the momentum until the trend exhausts.</p>
                </div>
            </div>

            <div class="bg-stone-900 text-white p-8 rounded-2xl shadow-xl flex flex-col md:flex-row items-center gap-8">
                <div class="flex-1">
                    <h4 class="text-emerald-400 font-bold uppercase tracking-widest text-xs mb-2">Core Philosophy</h4>
                    <h3 class="text-2xl font-bold mb-4 italic">"Don't predict the direction. React to the expansion."</h3>
                    <p class="text-stone-400 text-sm leading-relaxed">The ORB strategy doesn't care if a stock is "overvalued" or "undervalued." It only cares about where the money is flowing at 9:35 AM or 9:45 AM. By using fixed levels, we remove emotion and trade strictly based on price action.</p>
                </div>
                <div class="w-full md:w-64 bg-stone-800 p-4 rounded-xl border border-stone-700">
                    <p class="text-xs font-mono text-stone-400 mb-2">// QUICK CHECKLIST</p>
                    <ul class="text-xs space-y-2">
                        <li class="flex items-center gap-2"><div class="w-1 h-1 bg-emerald-500 rounded-full"></div> Identify the High/Low</li>
                        <li class="flex items-center gap-2"><div class="w-1 h-1 bg-emerald-500 rounded-full"></div> Wait for a Range Exit</li>
                        <li class="flex items-center gap-2"><div class="w-1 h-1 bg-emerald-500 rounded-full"></div> Set Stop at Range Mid</li>
                        <li class="flex items-center gap-2"><div class="w-1 h-1 bg-emerald-500 rounded-full"></div> Target 2:1 RR Ratio</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- SECTION 2: VISUAL LEGEND -->
        <section id="content-visuals" class="hidden space-y-6">
            <div class="max-w-3xl">
                <h2 class="text-2xl font-bold text-stone-900">Understanding the Chart Levels</h2>
                <p class="text-stone-600 mt-2">The indicator automatically draws levels based on the first few minutes of trading. The area between the High and Low is the <strong>Range (Gray Box)</strong>—think of this as the consolidation zone before the "big move" happens.</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <div class="lg:col-span-3 bg-white rounded-xl shadow-sm border border-stone-200 p-6">
                    <div class="chart-container">
                        <canvas id="legendChart"></canvas>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="bg-white p-5 rounded-xl border border-stone-200 shadow-sm">
                        <h3 class="font-bold text-sm text-stone-400 uppercase tracking-widest mb-3">Legend Key</h3>
                        <div id="legend-text" class="text-sm text-stone-600 space-y-3">
                            <p>Click the level names below the chart to toggle them. Hover over the price line to see the specific values.</p>
                        </div>
                    </div>
                    <div class="bg-stone-900 text-white p-5 rounded-xl shadow-lg">
                        <h4 class="font-bold text-emerald-400 text-sm mb-2">The Gray Box Rule</h4>
                        <p class="text-xs text-stone-300 leading-relaxed">Price inside the gray box is in "Discovery Mode." We only look for trades once a candle leaves this shaded area.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: STRATEGIES -->
        <section id="content-strategies" class="hidden space-y-6">
            <div class="flex flex-col md:flex-row md:items-end justify-between gap-4">
                <div class="max-w-2xl">
                    <h2 class="text-2xl font-bold text-stone-900">Breakouts vs. Breakdowns</h2>
                    <p class="text-stone-600 mt-1">The ORB strategy is direction-neutral. We react to whichever side the market chooses. Switch directions below to see the different setups.</p>
                </div>
                <div class="inline-flex bg-stone-200 p-1 rounded-lg">
                    <button onclick="setDirection('long')" id="btn-long" class="px-4 py-2 rounded-md text-sm font-bold transition-all bg-white text-emerald-600 shadow-sm">Long (Breakout)</button>
                    <button onclick="setDirection('short')" id="btn-short" class="px-4 py-2 rounded-md text-sm font-bold transition-all text-stone-600 hover:text-stone-900">Short (Breakdown)</button>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                <div class="lg:col-span-4 space-y-3">
                    <button onclick="setStrategy(0)" id="btn-strat-0" class="strategy-btn active w-full text-left p-4 rounded-xl border border-stone-200 bg-white transition-all">
                        <span class="block font-bold text-stone-900">1. Standard Close</span>
                        <span class="text-xs text-stone-500">Wait for candle to close outside the range.</span>
                    </button>
                    <button onclick="setStrategy(1)" id="btn-strat-1" class="strategy-btn w-full text-left p-4 rounded-xl border border-stone-200 bg-white transition-all">
                        <span class="block font-bold text-stone-900">2. Momentum Wick</span>
                        <span class="text-xs text-stone-500">Enter immediately on level touch.</span>
                    </button>
                    <button onclick="setStrategy(2)" id="btn-strat-2" class="strategy-btn w-full text-left p-4 rounded-xl border border-stone-200 bg-white transition-all">
                        <span class="block font-bold text-stone-900">3. The Retest</span>
                        <span class="text-xs text-stone-500">Wait for price to return and hold the level.</span>
                    </button>
                    <button onclick="setStrategy(3)" id="btn-strat-3" class="strategy-btn w-full text-left p-4 rounded-xl border border-stone-200 bg-white transition-all">
                        <span class="block font-bold text-stone-900" id="btn-label-mid">4. Mid-Line Support</span>
                        <span class="text-xs text-stone-500">Defense of the 50% equilibrium.</span>
                    </button>
                </div>
                <div class="lg:col-span-8 bg-white rounded-xl shadow-sm border border-stone-200 p-6">
                    <div id="strat-desc-box" class="mb-4 p-4 rounded-lg bg-stone-50 border-l-4 border-emerald-500">
                        <h3 class="font-bold text-stone-900" id="strat-title">Standard Breakout</h3>
                        <p class="text-sm text-stone-600 mt-1" id="strat-desc">Waiting for a candle to close above/below the range ensures the move has real volume behind it.</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="strategyChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: RISK -->
        <section id="content-risk" class="hidden space-y-6">
            <div class="max-w-3xl">
                <h2 class="text-2xl font-bold text-stone-900">Smart Sizing</h2>
                <p class="text-stone-600">The most important number isn't your profit target—it's your <strong>Stop Loss Width</strong>.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-sm border border-stone-200 p-8">
                    <h3 class="font-bold text-stone-800 mb-6 flex items-center gap-2">
                        <span class="w-2 h-6 bg-emerald-500 rounded"></span> Position Calculator
                    </h3>
                    <div class="space-y-5">
                        <div>
                            <label class="block text-xs font-bold text-stone-400 uppercase mb-1">Account Balance ($)</label>
                            <input type="number" id="accSize" value="25000" class="w-full p-3 bg-stone-50 border border-stone-200 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500 font-bold">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-bold text-stone-400 uppercase mb-1">Risk per Trade (%)</label>
                                <input type="number" id="riskP" value="1" step="0.5" class="w-full p-3 bg-stone-50 border border-stone-200 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500">
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-stone-400 uppercase mb-1">Stop Width (Price)</label>
                                <input type="number" id="stopW" value="0.75" step="0.01" class="w-full p-3 bg-stone-50 border border-stone-200 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500">
                                <span class="text-[10px] text-stone-400 mt-1 block italic">Distance from Entry to Stop in Dollars.</span>
                            </div>
                        </div>
                        <div class="pt-6 border-t border-stone-100 flex justify-between items-end">
                            <div>
                                <p class="text-xs text-stone-400 font-bold">Cash at Risk</p>
                                <p class="text-2xl font-bold text-rose-500" id="resRisk">$250.00</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xs text-stone-400 font-bold">Shares/Contracts</p>
                                <p class="text-3xl font-bold text-stone-900" id="resSize">333</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <div class="bg-white border border-stone-200 p-6 rounded-xl shadow-sm">
                        <h4 class="font-bold text-stone-900 mb-2">What is "Stop Width"?</h4>
                        <p class="text-sm text-stone-600 leading-relaxed">It is the difference between your <strong>Entry Price</strong> and your <strong>Stop Price</strong>. <br><br>Example: If you enter a Long at $150.50 and your stop is at the OR Mid ($150.00), your Stop Width is <strong>$0.50</strong>.</p>
                    </div>
                    <div class="bg-emerald-50 border border-emerald-100 p-6 rounded-xl">
                        <h4 class="font-bold text-emerald-900 mb-2">Target Logic</h4>
                        <ul class="text-sm text-emerald-800 space-y-2">
                            <li class="flex items-center gap-2">✅ <strong>TP1:</strong> Exit 50% at PDH or PDL.</li>
                            <li class="flex items-center gap-2">✅ <strong>TP2:</strong> Exit 25% at 2:1 Risk/Reward.</li>
                            <li class="flex items-center gap-2">✅ <strong>Runner:</strong> Move stop to breakeven.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 5: CONTEXT -->
        <section id="content-context" class="hidden space-y-6">
            <div class="max-w-3xl">
                <h2 class="text-2xl font-bold text-stone-900">Timeframe & Market Setup</h2>
                <p class="text-stone-600">The timeframe you choose changes the range width and the reliability of the signal.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-xl border-2 border-emerald-500 shadow-md relative">
                    <div class="absolute -top-3 left-6 bg-emerald-500 text-white text-[10px] font-bold px-2 py-0.5 rounded">MOST COMMON</div>
                    <h4 class="text-lg font-bold text-stone-900 mb-2">5-Minute ORB</h4>
                    <p class="text-sm text-stone-500 mb-4">The Standard Entry.</p>
                    <p class="text-xs text-stone-600 leading-relaxed">Best for active traders on liquid stocks. Captures the move early, but requires quick reflexes and a tolerance for "whipsaws."</p>
                </div>
                <div class="bg-white p-6 rounded-xl border border-stone-200">
                    <h4 class="text-lg font-bold text-stone-900 mb-2">15-Minute ORB</h4>
                    <p class="text-sm text-stone-500 mb-4">The Balanced/Institutional Entry.</p>
                    <p class="text-xs text-stone-600 leading-relaxed">Filters out the initial "morning wash." Gives institutional algos time to show their hand. Much higher win rate than the 5m.</p>
                </div>
                <div class="bg-white p-6 rounded-xl border border-stone-200">
                    <h4 class="text-lg font-bold text-stone-900 mb-2">30-Minute ORB</h4>
                    <p class="text-sm text-stone-500 mb-4">High Conviction Entry.</p>
                    <p class="text-xs text-stone-600 leading-relaxed">Requires the most patience. If the 30-minute range breaks, it usually signals a trend that will last the entire trading session.</p>
                </div>
            </div>

            <div class="bg-rose-50 border border-rose-100 p-6 rounded-xl">
                <h4 class="font-bold text-rose-900 mb-2">The "No-Go" Condition</h4>
                <p class="text-sm text-rose-800">If the opening range is already wider than the average daily move (ATR) of the stock, the move is likely exhausted. <strong>Do not trade "Elephant Candles" at the open.</strong></p>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-stone-200 py-8 mt-12">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 flex flex-col items-center">
            <p class="text-sm text-stone-500 font-medium tracking-tight">
                &copy; <span id="year"></span> TheInvestorToolkit.com
            </p>
            <p class="text-[10px] text-stone-400 mt-2 uppercase tracking-widest">Empowering Traders with Universal Logic</p>
        </div>
    </footer>

    <script>
        // Update Year
        document.getElementById('year').textContent = new Date().getFullYear();

        // --- Navigation ---
        function switchTab(id) {
            document.querySelectorAll('button[id^="tab-"]').forEach(b => b.className = 'tab-inactive py-4 px-1 text-sm whitespace-nowrap transition-all cursor-pointer');
            document.getElementById('tab-' + id).className = 'tab-active py-4 px-1 text-sm whitespace-nowrap transition-all cursor-pointer';
            ['overview', 'visuals', 'strategies', 'risk', 'context'].forEach(sec => {
                const el = document.getElementById('content-' + sec);
                if (el) el.classList.toggle('hidden', sec !== id);
            });
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- Chart 1: Legend ---
        const legCtx = document.getElementById('legendChart').getContext('2d');
        const legendChart = new Chart(legCtx, {
            type: 'line',
            data: {
                labels: ['9:30', '9:35', '9:40', '9:45', '9:50', '9:55', '10:00'],
                datasets: [
                    { label: 'Price', data: [100.2, 101.5, 100.8, 102.5, 104, 103, 105], borderColor: '#57534e', borderWidth: 2, pointRadius: 0, tension: 0.4 },
                    { label: 'OR High', data: Array(7).fill(103), borderColor: '#10b981', pointRadius: 0 },
                    { label: 'OR Low', data: Array(7).fill(100.5), borderColor: '#f43f5e', pointRadius: 0 },
                    { label: 'OR Mid', data: Array(7).fill(101.75), borderColor: '#3b82f6', borderDash: [4,4], pointRadius: 0 }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: { mode: 'index', intersect: false }
                },
                scales: { y: { display: true }, x: { grid: { display: false } } }
            }
        });

        // Add Gray Box via custom plugin
        Chart.register({
            id: 'grayBox',
            beforeDraw: (chart) => {
                if (chart.canvas.id !== 'legendChart') return;
                const {ctx, chartArea: {left, top, right, bottom}, scales: {x, y}} = chart;
                const high = y.getPixelForValue(103);
                const low = y.getPixelForValue(100.5);
                ctx.save();
                ctx.fillStyle = 'rgba(120, 113, 108, 0.15)';
                ctx.fillRect(left, high, right - left, low - high);
                ctx.restore();
            }
        });

        // --- Chart 2: Strategy Simulator ---
        let currentDir = 'long';
        let currentStrat = 0;
        const stratCtx = document.getElementById('strategyChart').getContext('2d');
        
        const stratProfiles = {
            long: [
                { title: 'Standard Breakout', desc: 'Wait for a 5m candle close above the green line.', data: [100, 102, 101, 103, 105.5, 108, 110] },
                { title: 'Momentum Wick', desc: 'Enter as soon as price crosses the green line.', data: [100, 101, 105.2, 105.8, 107, 109, 111] },
                { title: 'The Retest', desc: 'Price breaks out, pulls back to the high, and holds.', data: [100, 106, 107, 105.1, 105.0, 108, 110] },
                { title: 'Mid-Line Support (Bounce)', desc: 'Price dips into the range but defends the blue mid-line.', data: [100, 106, 107, 103, 102.6, 105, 108] }
            ],
            short: [
                { title: 'Standard Breakdown', desc: 'Wait for a 5m candle close below the red line.', data: [105, 103, 104, 102, 99.5, 97, 95] },
                { title: 'Momentum Wick', desc: 'Enter as soon as price crosses the red line.', data: [105, 104, 100.1, 99.5, 98, 96, 94] },
                { title: 'The Retest', desc: 'Price breaks down, rallies back to the low, and fails.', data: [105, 99, 98, 100.2, 100.5, 97, 95] },
                { title: 'Mid-Line Resistance (Reject)', desc: 'Price rallies into the range but hits a ceiling at the blue mid-line.', data: [105, 99, 98, 101.5, 102.2, 99, 96] }
            ]
        };

        const strategyChart = new Chart(stratCtx, {
            type: 'line',
            data: {
                labels: ['1', '2', '3', '4', '5', '6', '7'],
                datasets: [
                    { label: 'Price', data: stratProfiles.long[0].data, borderColor: '#57534e', pointRadius: 4, tension: 0.3 },
                    { label: 'OR High', data: Array(7).fill(105), borderColor: '#10b981', pointRadius: 0 },
                    { label: 'OR Low', data: Array(7).fill(100), borderColor: '#f43f5e', pointRadius: 0 },
                    { label: 'OR Mid', data: Array(7).fill(102.5), borderColor: '#3b82f6', borderDash: [4,4], pointRadius: 0 }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } }
            }
        });

        function setDirection(dir) {
            currentDir = dir;
            document.getElementById('btn-long').className = dir === 'long' ? 'px-4 py-2 rounded-md text-sm font-bold transition-all bg-white text-emerald-600 shadow-sm' : 'px-4 py-2 rounded-md text-sm font-bold transition-all text-stone-600 hover:text-stone-900';
            document.getElementById('btn-short').className = dir === 'short' ? 'px-4 py-2 rounded-md text-sm font-bold transition-all bg-white text-rose-600 shadow-sm' : 'px-4 py-2 rounded-md text-sm font-bold transition-all text-stone-600 hover:text-stone-900';
            const borderCol = dir === 'long' ? '#10b981' : '#f43f5e';
            document.getElementById('strat-desc-box').style.borderColor = borderCol;
            
            // Update button label
            document.getElementById('btn-label-mid').innerText = dir === 'long' ? '4. Mid-Line Support' : '4. Mid-Line Resistance';
            
            updateStrat();
        }

        function setStrategy(idx) {
            currentStrat = idx;
            document.querySelectorAll('.strategy-btn').forEach((b, i) => b.classList.toggle('active', i === idx));
            updateStrat();
        }

        function updateStrat() {
            const profile = stratProfiles[currentDir][currentStrat];
            document.getElementById('strat-title').innerText = profile.title;
            document.getElementById('strat-desc').innerText = profile.desc;
            strategyChart.data.datasets[0].data = profile.data;
            strategyChart.update();
        }

        // --- Calc ---
        function runCalc() {
            const acc = parseFloat(document.getElementById('accSize').value) || 0;
            const risk = parseFloat(document.getElementById('riskP').value) || 0;
            const width = parseFloat(document.getElementById('stopW').value) || 0;
            const cashRisk = acc * (risk / 100);
            document.getElementById('resRisk').innerText = '$' + cashRisk.toFixed(2);
            document.getElementById('resSize').innerText = width > 0 ? Math.floor(cashRisk / width).toLocaleString() : 0;
        }
        ['accSize', 'riskP', 'stopW'].forEach(id => document.getElementById(id).addEventListener('input', runCalc));
        runCalc();
    </script>
</body>
</html>
